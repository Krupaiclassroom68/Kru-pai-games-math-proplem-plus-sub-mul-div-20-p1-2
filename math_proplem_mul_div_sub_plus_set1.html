<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Story Math ¬∑ ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑ ¬∑ Kru Pai Classroom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: "Tahoma", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #fff9c4 0, #81d4fa 40%, #01579b 100%);
      color: #0d1b2a;
    }

    .app-container {
      width: 100%;
      max-width: 900px;
      padding: 16px;
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
      border: 2px solid #ffeb3b;
    }

    h1, h2, h3 {
      margin: 0 0 12px;
    }

    h1 {
      font-size: 1.9rem;
      text-align: center;
      color: #0277bd;
      text-shadow: 0 0 6px rgba(255, 255, 255, 0.9);
    }

    h2 {
      font-size: 1.1rem;
      text-align: center;
      color: #ffb300;
    }

    .subtitle {
      text-align: center;
      font-size: 0.95rem;
      color: #455a64;
      margin-bottom: 18px;
      white-space: pre-line;
    }

    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 18px;
    }

    label {
      font-size: 0.95rem;
    }

    input[type="text"] {
      padding: 8px 10px;
      border-radius: 10px;
      border: 2px solid #81d4fa;
      min-width: 220px;
      font-size: 1rem;
      outline: none;
    }

    .lang-row {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .lang-btn {
      border-radius: 999px;
      border: 1px solid #90caf9;
      padding: 6px 14px;
      font-size: 0.85rem;
      cursor: pointer;
      background: #e3f2fd;
      color: #01579b;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .lang-btn.active {
      background: #ffeb3b;
      color: #000;
      border-color: #fdd835;
      box-shadow: 0 0 10px rgba(255, 235, 59, 0.8);
      font-weight: bold;
    }

    .primary-btn {
      display: block;
      margin: 10px auto 0;
      border: none;
      border-radius: 999px;
      padding: 10px 26px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      background: linear-gradient(135deg, #29b6f6, #0288d1);
      color: #fff;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.15s;
    }

    .primary-btn:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
    }

    .primary-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.55);
    }

    .top-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.9rem;
      margin-bottom: 10px;
      align-items: center;
    }

    .tag {
      padding: 4px 10px;
      border-radius: 999px;
      background: #e3f2fd;
      color: #01579b;
      border: 1px solid #81d4fa;
    }

    .score-tag {
      background: #fff9c4;
      color: #e65100;
      border-color: #ffeb3b;
      font-weight: bold;
    }

    .question-box {
      background: #fffde7;
      border-radius: 14px;
      padding: 12px 14px;
      margin-bottom: 12px;
      border: 1px solid #ffe082;
      font-size: 1.05rem;
      line-height: 1.5;
      white-space: normal;
      color: #4e342e;
    }

    .equation-area {
      margin: 14px 0;
    }

    .equation-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;
      margin: 6px 0;
      flex-wrap: wrap;
    }

    .equation-line-label {
      min-width: 200px;
      text-align: right;
      font-size: 0.95rem;
      color: #0277bd;
    }

    .equation-line-slots {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .square-slot,
    .square-slot.answer-slot {
      width: 62px;
      height: 62px;
      border-radius: 12px;
      border: 3px solid #29b6f6;
      background: #ffffff;
      color: #0277bd;
      font-size: 1.3rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
    }

    .square-slot.answer-slot {
      border-color: #ffca28;
      background: #fff8e1;
      color: #e65100;
    }

    .circle-slot {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 3px solid #ffca28;
      background: #fffde7;
      color: #ff8f00;
      font-size: 1.6rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
    }

    .slot-label {
      font-size: 1.4rem;
      padding: 0 6px;
    }

    .slot.selected {
      box-shadow: 0 0 0 3px rgba(0, 150, 255, 0.8);
    }

    .slot.disabled {
      opacity: 0.6;
      cursor: default;
    }

    .keypad {
      margin-top: 8px;
      background: #e3f2fd;
      border-radius: 14px;
      padding: 10px;
      border: 1px solid #90caf9;
    }

    .keypad-row {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }

    .key-btn {
      min-width: 48px;
      padding: 10px 0;
      border-radius: 12px;
      border: none;
      background: #29b6f6;
      color: #fff;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
      transition: transform 0.05s ease, box-shadow 0.05s ease;
    }

    .key-btn.op {
      background: #ffca28;
      color: #000;
    }

    .key-btn.special {
      background: #8e24aa;
      font-size: 0.9rem;
      padding: 8px 6px;
    }

    .key-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    }

    .bottom-controls {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .msg-area {
      min-height: 32px;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #37474f;
    }

    .emoji {
      font-size: 1.4rem;
    }

    .btn-group-right {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .small-btn {
      border-radius: 999px;
      border: none;
      padding: 7px 16px;
      font-size: 0.85rem;
      cursor: pointer;
      background: #0288d1;
      color: #fff;
      box-shadow: 0 3px 8px rgba(0,0,0,0.4);
    }

    #check-btn {
      background: linear-gradient(135deg, #00e676, #00c853);
      font-size: 0.95rem;
      font-weight: bold;
      padding: 9px 20px;
      min-width: 120px;
    }

    #next-btn {
      background: #ff9800;
    }

    #back-home-btn {
      background: #546e7a;
    }

    .confetti-piece {
      position: fixed;
      width: 10px;
      height: 14px;
      background: #ffeb3b;
      border-radius: 2px;
      opacity: 0.9;
      pointer-events: none;
      animation: confetti-fall 1.5s linear forwards;
      z-index: 9999;
    }

    @keyframes confetti-fall {
      0% {
        transform: translate3d(var(--x-start), -60px, 0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translate3d(var(--x-end), 110vh, 0) rotate(340deg);
        opacity: 0;
      }
    }

    @media (max-width: 600px) {
      .square-slot,
      .square-slot.answer-slot {
        width: 54px;
        height: 54px;
        font-size: 1.1rem;
      }

      .circle-slot {
        width: 50px;
        height: 50px;
        font-size: 1.4rem;
      }

      .card {
        padding: 16px;
      }

      h1 {
        font-size: 1.6rem;
      }

      .question-box {
        font-size: 1rem;
      }

      .equation-line-label {
        min-width: 150px;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- START SCREEN -->
    <div id="start-screen" class="card">
      <h1 id="title-text">Story Math ¬∑ ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑</h1>
      <h2 id="subtitle-brand">Kru Pai Classroom</h2>

      <div class="lang-row">
        <button class="lang-btn active" data-lang="th">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</button>
        <button class="lang-btn" data-lang="en">English</button>
      </div>

      <p class="subtitle" id="subtitle-detail">
        ‡πÄ‡∏Å‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å ‡∏õ.1‚Äì2
‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏•‡∏∞‡∏ß‡∏á‡∏Å‡∏•‡∏°
      </p>

      <div class="input-row">
        <div>
          <label id="label-name" for="student-name">‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô :</label><br />
          <input id="student-name" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏à‡πâ‡∏≤" />
        </div>
      </div>

      <p class="subtitle" id="subtitle-how">
        ‚ú® ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠, ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö
‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î "‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö" ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏ï‡∏ï‡∏µ‡πâ‡∏â‡∏•‡∏≠‡∏á üéâ
      </p>

      <button id="start-btn" class="primary-btn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå 20 ‡∏Ç‡πâ‡∏≠</button>
    </div>

    <!-- GAME SCREEN -->
    <div id="game-screen" class="card" style="display:none;">
      <div class="top-bar">
        <div class="tag" id="name-display">üëß ‡∏ä‡∏∑‡πà‡∏≠: -</div>
        <div class="tag" id="q-display">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1/20</div>
        <div class="tag score-tag" id="score-display">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0/0</div>
      </div>

      <div class="question-box" id="question-text"></div>

      <div class="equation-area" id="equation-area"></div>

      <div class="keypad">
        <div class="keypad-row">
          <button class="key-btn" data-key="7">7</button>
          <button class="key-btn" data-key="8">8</button>
          <button class="key-btn" data-key="9">9</button>
        </div>
        <div class="keypad-row">
          <button class="key-btn" data-key="4">4</button>
          <button class="key-btn" data-key="5">5</button>
          <button class="key-btn" data-key="6">6</button>
        </div>
        <div class="keypad-row">
          <button class="key-btn" data-key="1">1</button>
          <button class="key-btn" data-key="2">2</button>
          <button class="key-btn" data-key="3">3</button>
        </div>
        <div class="keypad-row">
          <button class="key-btn" data-key="0">0</button>
          <button class="key-btn op" data-key="+">+</button>
          <button class="key-btn op" data-key="-">-</button>
        </div>
        <div class="keypad-row">
          <button class="key-btn op" data-key="√ó">√ó</button>
          <button class="key-btn op" data-key="√∑">√∑</button>
        </div>
        <div class="keypad-row">
          <button class="key-btn special" id="clear-slot">‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á</button>
          <button class="key-btn special" id="clear-all">‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£</button>
        </div>
      </div>

      <div class="bottom-controls">
        <div class="msg-area" id="message-area"></div>
        <div class="btn-group-right">
          <button class="small-btn" id="back-home-btn">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
          <button class="small-btn" id="check-btn">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
          <button class="small-btn" id="next-btn">‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ------------------ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ------------------
    let audioCtx = null;
    function ensureAudioCtx() {
      if (!audioCtx) {
        const AC = window.AudioContext || window.webkitAudioContext;
        if (!AC) return null;
        audioCtx = new AC();
      }
      return audioCtx;
    }

    function playBeep(freq = 660, duration = 0.08, vol = 0.15) {
      const ctx = ensureAudioCtx();
      if (!ctx) return;
      try {
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = "sine";
        osc.frequency.value = freq;
        osc.connect(gain);
        gain.connect(ctx.destination);
        const now = ctx.currentTime;
        gain.gain.setValueAtTime(vol, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + duration);
        osc.start(now);
        osc.stop(now + duration);
      } catch (e) {}
    }

    function playSuccessSound() {
      playBeep(880, 0.07, 0.18);
      setTimeout(() => playBeep(1200, 0.09, 0.18), 60);
    }

    function playFailSound() {
      playBeep(260, 0.12, 0.18);
    }

    function playFinishSetSound() {
      playBeep(740, 0.09, 0.18);
      setTimeout(() => playBeep(980, 0.09, 0.18), 90);
      setTimeout(() => playBeep(1240, 0.12, 0.2), 180);
    }

    // --------------- Confetti ---------------
    function launchConfetti(count = 60) {
      for (let i = 0; i < count; i++) {
        const piece = document.createElement("div");
        piece.className = "confetti-piece";
        const startX = Math.random() * 100;
        const endX = startX + (Math.random() * 40 - 20);
        piece.style.setProperty("--x-start", startX + "vw");
        piece.style.setProperty("--x-end", endX + "vw");
        const colors = ["#ffeb3b", "#ff4081", "#40c4ff", "#81c784", "#ffb74d"];
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        document.body.appendChild(piece);
        setTimeout(() => piece.remove(), 1600);
      }
    }

    // --------------- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° 2 ‡∏†‡∏≤‡∏©‡∏≤ ---------------
    const uiText = {
      th: {
        title: "Story Math ¬∑ ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑",
        subtitleDetail:
          "‡πÄ‡∏Å‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å ‡∏õ.1‚Äì2\n‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏•‡∏∞‡∏ß‡∏á‡∏Å‡∏•‡∏°",
        labelName: "‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô :",
        namePlaceholder: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏à‡πâ‡∏≤",
        how: "‚ú® ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠, ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö\n‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î \"‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö\" ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏ï‡∏ï‡∏µ‡πâ‡∏â‡∏•‡∏≠‡∏á üéâ",
        startBtn: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå 20 ‡∏Ç‡πâ‡∏≠",
        backHome: "‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å",
        check: "‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö",
        next: "‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ",
        clearSlot: "‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á",
        clearAll: "‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£",
        msgHintSelectSlot: "‡πÅ‡∏ï‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏à‡πä‡∏∞ üí°",
        msgNeedFillAll: "‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏à‡πä‡∏∞ ‚úèÔ∏è",
        msgTryAgain: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á ‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏ô‡∏∞ üí™",
        msgShowAnswer: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏∞‡∏à‡πä‡∏∞ ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏â‡∏•‡∏¢‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á üåü",
        msgCorrect: "‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! Wowwww! üéâ",
        msgStartQuestion: "‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏∞‡∏à‡πä‡∏∞ üíõ",
        msgClearSlotNeedSelect: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏Å‡∏î‡∏•‡∏ö‡∏ô‡∏∞‡∏à‡πä‡∏∞ üßΩ",
        msgResetEq: "‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞ ‚úèÔ∏è",
        topName: name => `üëß ‡∏ä‡∏∑‡πà‡∏≠: ${name}`,
        topQ: (index, total) => `‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${index}/${total}`,
        topScore: (score, totalAsked) => `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}/${totalAsked}`,
        finishPerfect: (score, total) =>
          `‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏°‡∏≤‡∏Å! ‡πÑ‡∏î‡πâ ${score}/${total} ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏•‡∏¢ üéâ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢‡∏à‡πâ‡∏≤`,
        finishNormal: (score, total) =>
          `‡∏à‡∏ö 20 ‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏î‡πâ ${score}/${total} ‡∏Ç‡πâ‡∏≠ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏ã‡πâ‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏∞ üåü`
      },
      en: {
        title: "Story Math ¬∑ Mixed + ‚àí √ó √∑",
        subtitleDetail:
          "Mixed + ‚àí √ó √∑ word problems for Grade 1‚Äì2.\nRead the story and write your own equation in the boxes.",
        labelName: "Student name:",
        namePlaceholder: "Type your name here",
        how: "‚ú® How to play: Read the story, fill in the numbers and sign, then press \"Check\".\nIf your equation is correct, confetti will celebrate! üéâ",
        startBtn: "Start 20 Problems",
        backHome: "Back to start",
        check: "Check",
        next: "Next",
        clearSlot: "Clear box",
        clearAll: "Clear equation",
        msgHintSelectSlot: "Tap the box you want to fill first üí°",
        msgNeedFillAll: "Please fill in all boxes first ‚úèÔ∏è",
        msgTryAgain: "Not correct yet, try again üí™",
        msgShowAnswer: "It's not correct. Here is the right answer üåü",
        msgCorrect: "Great job! Wowwww! üéâ",
        msgStartQuestion: "Read the story carefully, then fill in the equation üíõ",
        msgClearSlotNeedSelect: "Select a box before clearing it üßΩ",
        msgResetEq: "Let's clear and start the equation again ‚úèÔ∏è",
        topName: name => `üëß Name: ${name}`,
        topQ: (index, total) => `Question ${index}/${total}`,
        topScore: (score, totalAsked) => `Score: ${score}/${totalAsked}`,
        finishPerfect: (score, total) =>
          `Amazing! You got ${score}/${total} üéâ You are a math star!`,
        finishNormal: (score, total) =>
          `You finished all ${total} problems! Score: ${score}/${total}. You can try again to improve üåü`
      }
    };

    // --------------- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏à‡∏ó‡∏¢‡πå 20 ‡∏Ç‡πâ‡∏≠ ‡∏£‡∏∞‡∏Ñ‡∏ô + ‚àí √ó √∑ ---------------
    const questions = [
      {
        story: {
          th: "‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏≠‡∏° 8 ‡πÄ‡∏°‡πá‡∏î ‡πÅ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏≤‡∏≠‡∏µ‡∏Å 7 ‡πÄ‡∏°‡πá‡∏î ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡πÄ‡∏°‡πá‡∏î?",
          en: "You have 8 candies. Mom gives you 7 more. How many candies do you have in total?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total candies ="
        },
        num1: 8, num2: 7, op: "+", ans: 15
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á 20 ‡πÉ‡∏ö ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏Å‡πÑ‡∏õ 6 ‡πÉ‡∏ö ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏Å‡∏µ‡πà‡πÉ‡∏ö?",
          en: "There are 20 balloons. 6 balloons pop. How many balloons are left?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ =",
          en: "Balloons left ="
        },
        num1: 20, num2: 6, op: "-", ans: 14
      },
      {
        story: {
          th: "‡πÉ‡∏ô‡∏ñ‡∏∏‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏î‡∏¥‡∏ô‡∏™‡∏≠ 4 ‡πÅ‡∏ó‡πà‡∏á ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ñ‡∏∏‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô 5 ‡∏ñ‡∏∏‡∏á ‡∏à‡∏∞‡∏°‡∏µ‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡πÅ‡∏ó‡πà‡∏á?",
          en: "There are 4 pencils in one bag. If there are 5 bags, how many pencils are there in total?"
        },
        eqLabel: {
          th: "‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total pencils ="
        },
        num1: 4, num2: 5, op: "√ó", ans: 20
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏™‡πâ‡∏° 24 ‡∏ú‡∏• ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô 3 ‡∏Ñ‡∏ô‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏™‡πâ‡∏°‡∏Å‡∏µ‡πà‡∏ú‡∏•?",
          en: "There are 24 oranges. They are shared equally among 3 friends. How many oranges does each friend get?"
        },
        eqLabel: {
          th: "‡∏™‡πâ‡∏°‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô =",
          en: "Oranges per friend ="
        },
        num1: 24, num2: 3, op: "√∑", ans: 8
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå 9 ‡∏î‡∏ß‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏≤‡∏≠‡∏µ‡∏Å 12 ‡∏î‡∏ß‡∏á ‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡∏î‡∏ß‡∏á?",
          en: "You have 9 stickers. Your friend gives you 12 more. How many stickers do you have now?"
        },
        eqLabel: {
          th: "‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total stickers ="
        },
        num1: 9, num2: 12, op: "+", ans: 21
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏™‡∏µ 18 ‡πÅ‡∏ó‡πà‡∏á ‡∏ó‡∏≥‡∏´‡∏≤‡∏¢‡πÑ‡∏õ 9 ‡πÅ‡∏ó‡πà‡∏á ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏™‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏µ‡πà‡πÅ‡∏ó‡πà‡∏á?",
          en: "You have 18 color pencils. You lose 9 of them. How many color pencils are left?"
        },
        eqLabel: {
          th: "‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ =",
          en: "Color pencils left ="
        },
        num1: 18, num2: 9, op: "-", ans: 9
      },
      {
        story: {
          th: "‡∏ö‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á‡∏°‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ 3 ‡πÄ‡∏•‡πà‡∏°‡∏ï‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ 8 ‡∏ä‡πà‡∏≠‡∏á ‡∏à‡∏∞‡∏°‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡πÄ‡∏•‡πà‡∏°?",
          en: "Each shelf section has 3 books. If there are 8 sections, how many books are there in total?"
        },
        eqLabel: {
          th: "‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total books ="
        },
        num1: 3, num2: 8, op: "√ó", ans: 24
      },
      {
        story: {
          th: "‡∏•‡∏π‡∏Å‡∏≠‡∏° 35 ‡πÄ‡∏°‡πá‡∏î ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πá‡∏Å 5 ‡∏Ñ‡∏ô‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô ‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡πÄ‡∏°‡πá‡∏î?",
          en: "There are 35 candies shared equally among 5 children. How many candies does each child get?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô =",
          en: "Candies per child ="
        },
        num1: 35, num2: 5, op: "√∑", ans: 7
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏£‡∏π‡∏õ‡∏´‡∏±‡∏ß‡πÉ‡∏à 7 ‡∏î‡∏ß‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏£‡∏π‡∏õ‡∏î‡∏≤‡∏ß 7 ‡∏î‡∏ß‡∏á ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏Å‡∏µ‡πà‡∏î‡∏ß‡∏á?",
          en: "You have 7 heart stickers and 7 star stickers. How many stickers do you have in all?"
        },
        eqLabel: {
          th: "‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total stickers ="
        },
        num1: 7, num2: 7, op: "+", ans: 14
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏≠‡∏° 40 ‡πÄ‡∏°‡πá‡∏î ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ 16 ‡πÄ‡∏°‡πá‡∏î ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏Å‡∏µ‡πà‡πÄ‡∏°‡πá‡∏î?",
          en: "You have 40 candies. You give 16 candies to your friends. How many candies are left?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ =",
          en: "Candies left ="
        },
        num1: 40, num2: 16, op: "-", ans: 24
      },
      {
        story: {
          th: "‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏° 6 ‡∏ä‡∏¥‡πâ‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ 9 ‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏à‡∏∞‡∏°‡∏µ‡∏Ç‡∏ô‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡∏ä‡∏¥‡πâ‡∏ô?",
          en: "There are 6 snacks in one box. If there are 9 boxes, how many snacks are there in total?"
        },
        eqLabel: {
          th: "‡∏Ç‡∏ô‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total snacks ="
        },
        num1: 6, num2: 9, op: "√ó", ans: 54
      },
      {
        story: {
          th: "‡∏ú‡∏•‡πÑ‡∏°‡πâ 56 ‡∏ä‡∏¥‡πâ‡∏ô ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏™‡πà‡∏à‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô 8 ‡∏à‡∏≤‡∏ô ‡∏à‡∏≤‡∏ô‡∏•‡∏∞‡∏Å‡∏µ‡πà‡∏ä‡∏¥‡πâ‡∏ô?",
          en: "There are 56 fruits shared equally into 8 plates. How many fruits on each plate?"
        },
        eqLabel: {
          th: "‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏ô =",
          en: "Fruits per plate ="
        },
        num1: 56, num2: 8, op: "√∑", ans: 7
      },
      {
        story: {
          th: "‡πÅ‡∏°‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏°‡∏°‡∏≤ 12 ‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏û‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å 15 ‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏à‡∏∞‡∏°‡∏µ‡∏ô‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á?",
          en: "Mom buys 12 boxes of milk. Dad buys 15 more. How many boxes of milk are there?"
        },
        eqLabel: {
          th: "‡∏ô‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total milk boxes ="
        },
        num1: 12, num2: 15, op: "+", ans: 27
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏î‡∏¥‡∏ô‡∏™‡∏≠ 25 ‡πÅ‡∏ó‡πà‡∏á ‡πÅ‡∏à‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ 7 ‡πÅ‡∏ó‡πà‡∏á ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏Å‡∏µ‡πà‡πÅ‡∏ó‡πà‡∏á?",
          en: "You have 25 pencils. You give 7 pencils to friends. How many pencils are left?"
        },
        eqLabel: {
          th: "‡∏î‡∏¥‡∏ô‡∏™‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ =",
          en: "Pencils left ="
        },
        num1: 25, num2: 7, op: "-", ans: 18
      },
      {
        story: {
          th: "‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 5 ‡∏Ñ‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ 6 ‡πÅ‡∏ñ‡∏ß ‡∏à‡∏∞‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô?",
          en: "There are 5 students in each row. If there are 6 rows, how many students are there in total?"
        },
        eqLabel: {
          th: "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total students ="
        },
        num1: 5, num2: 6, op: "√ó", ans: 30
      },
      {
        story: {
          th: "‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏• 72 ‡∏•‡∏π‡∏Å ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πá‡∏Å 9 ‡∏Ñ‡∏ô‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô ‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏•‡∏π‡∏Å?",
          en: "There are 72 balls shared equally among 9 children. How many balls does each child get?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô =",
          en: "Balls per child ="
        },
        num1: 72, num2: 9, op: "√∑", ans: 8
      },
      {
        story: {
          th: "‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏£‡∏Å‡∏°‡∏µ‡πÄ‡∏î‡πá‡∏Å 14 ‡∏Ñ‡∏ô ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡∏°‡∏µ‡πÄ‡∏î‡πá‡∏Å 9 ‡∏Ñ‡∏ô ‡πÄ‡∏î‡πá‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô?",
          en: "The first group has 14 children. The second group has 9. How many children are there in total?"
        },
        eqLabel: {
          th: "‡πÄ‡∏î‡πá‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total children ="
        },
        num1: 14, num2: 9, op: "+", ans: 23
      },
      {
        story: {
          th: "‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏≠‡∏° 19 ‡πÄ‡∏°‡πá‡∏î ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ 5 ‡πÄ‡∏°‡πá‡∏î ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏Å‡∏µ‡πà‡πÄ‡∏°‡πá‡∏î?",
          en: "You have 19 candies. You eat 5 of them. How many candies are left?"
        },
        eqLabel: {
          th: "‡∏•‡∏π‡∏Å‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ =",
          en: "Candies left ="
        },
        num1: 19, num2: 5, op: "-", ans: 14
      },
      {
        story: {
          th: "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ 8 ‡∏î‡∏≠‡∏Å‡∏ï‡πà‡∏≠‡πÅ‡∏à‡∏Å‡∏±‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ 7 ‡πÅ‡∏à‡∏Å‡∏±‡∏ô ‡∏à‡∏∞‡∏°‡∏µ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏µ‡πà‡∏î‡∏≠‡∏Å?",
          en: "There are 8 flowers in each vase. If there are 7 vases, how many flowers are there in total?"
        },
        eqLabel: {
          th: "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =",
          en: "Total flowers ="
        },
        num1: 8, num2: 7, op: "√ó", ans: 56
      },
      {
        story: {
          th: "‡∏ô‡∏¥‡∏ï‡∏¢‡∏™‡∏≤‡∏£ 48 ‡πÄ‡∏•‡πà‡∏° ‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏™‡πà‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô 6 ‡∏ä‡∏±‡πâ‡∏ô ‡∏ä‡∏±‡πâ‡∏ô‡∏•‡∏∞‡∏Å‡∏µ‡πà‡πÄ‡∏•‡πà‡∏°?",
          en: "There are 48 magazines shared equally on 6 shelves. How many magazines on each shelf?"
        },
        eqLabel: {
          th: "‡∏ô‡∏¥‡∏ï‡∏¢‡∏™‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô =",
          en: "Magazines per shelf ="
        },
        num1: 48, num2: 6, op: "√∑", ans: 8
      }
    ];

    // --------------- STATE ---------------
    let currentLang = "th";
    let currentIndex = 0; // 0-based
    let currentSlots = [];
    let selectedSlotIndex = null;
    let attempts = 0;
    let score = 0;
    let studentName = "";

    // --------------- DOM ---------------
    const startScreen = document.getElementById("start-screen");
    const gameScreen = document.getElementById("game-screen");

    const titleText = document.getElementById("title-text");
    const subtitleDetail = document.getElementById("subtitle-detail");
    const labelName = document.getElementById("label-name");
    const nameInput = document.getElementById("student-name");
    const howText = document.getElementById("subtitle-how");
    const startBtn = document.getElementById("start-btn");

    const langButtons = Array.from(document.querySelectorAll(".lang-btn"));

    const nameDisplay = document.getElementById("name-display");
    const qDisplay = document.getElementById("q-display");
    const scoreDisplay = document.getElementById("score-display");
    const questionText = document.getElementById("question-text");
    const equationArea = document.getElementById("equation-area");
    const messageArea = document.getElementById("message-area");

    const backHomeBtn = document.getElementById("back-home-btn");
    const checkBtn = document.getElementById("check-btn");
    const nextBtn = document.getElementById("next-btn");
    const keypadButtons = Array.from(document.querySelectorAll(".key-btn"));
    const clearSlotBtn = document.getElementById("clear-slot");
    const clearAllBtn = document.getElementById("clear-all");

    // --------------- Helper UI ---------------
    function setMessage(text, emoji) {
      messageArea.innerHTML = "";
      if (emoji) {
        const spanEmoji = document.createElement("span");
        spanEmoji.className = "emoji";
        spanEmoji.textContent = emoji;
        messageArea.appendChild(spanEmoji);
      }
      const spanText = document.createElement("span");
      spanText.textContent = text || "";
      messageArea.appendChild(spanText);
    }

    function clearSelectionHighlight() {
      const allSlots = equationArea.querySelectorAll(".slot");
      allSlots.forEach(s => s.classList.remove("selected"));
    }

    function setSlotsDisabled(disabled) {
      const allSlots = equationArea.querySelectorAll(".slot");
      allSlots.forEach(s => {
        if (disabled) {
          s.classList.add("disabled");
        } else {
          s.classList.remove("disabled");
        }
      });
    }

    function renderTopBar() {
      const t = uiText[currentLang];
      const total = questions.length;
      qDisplay.textContent = t.topQ(currentIndex + 1, total);
      scoreDisplay.textContent = t.topScore(score, currentIndex + 1);
      nameDisplay.textContent = t.topName(studentName || (currentLang === "th" ? "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" : "Student"));
    }

    function updateStartScreenTexts() {
      const t = uiText[currentLang];
      titleText.textContent = t.title;
      subtitleDetail.textContent = t.subtitleDetail;
      labelName.textContent = t.labelName;
      nameInput.placeholder = t.namePlaceholder;
      howText.textContent = t.how;
      startBtn.textContent = t.startBtn;

      backHomeBtn.textContent = t.backHome;
      checkBtn.textContent = t.check;
      nextBtn.textContent = t.next;
      clearSlotBtn.textContent = t.clearSlot;
      clearAllBtn.textContent = t.clearAll;

      if (studentName) {
        nameDisplay.textContent = t.topName(studentName);
      }
      renderTopBar();
    }

    // --------------- ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå ---------------
    function renderQuestion() {
      const t = uiText[currentLang];
      const q = questions[currentIndex];

      selectedSlotIndex = null;
      attempts = 0;
      currentSlots = [];

      questionText.textContent = q.story[currentLang];

      equationArea.innerHTML = "";

      const row = document.createElement("div");
      row.className = "equation-row";

      const labelDiv = document.createElement("div");
      labelDiv.className = "equation-line-label";
      labelDiv.textContent = q.eqLabel[currentLang];
      row.appendChild(labelDiv);

      const slotsWrap = document.createElement("div");
      slotsWrap.className = "equation-line-slots";

      const slotDefs = [
        { type: "num", correct: q.num1 },
        { type: "op", correct: q.op },
        { type: "num", correct: q.num2 },
        { type: "ans", correct: q.ans }
      ];
      currentSlots = slotDefs.map(s => ({ ...s, value: "" }));

      currentSlots.forEach((slot, idx) => {
        if (slot.type === "ans") {
          const eqSpan = document.createElement("span");
          eqSpan.className = "slot-label";
          eqSpan.textContent = "=";
          slotsWrap.appendChild(eqSpan);
        }

        const div = document.createElement("div");
        if (slot.type === "op") {
          div.className = "circle-slot slot";
        } else if (slot.type === "ans") {
          div.className = "square-slot answer-slot slot";
        } else {
          div.className = "square-slot slot";
        }
        div.dataset.index = idx;
        div.textContent = "";
        div.addEventListener("click", () => {
          if (div.classList.contains("disabled")) return;
          selectedSlotIndex = idx;
          clearSelectionHighlight();
          div.classList.add("selected");
          playBeep(520);
        });

        slotsWrap.appendChild(div);
      });

      row.appendChild(slotsWrap);
      equationArea.appendChild(row);

      setSlotsDisabled(false);
      renderTopBar();
      setMessage(t.msgStartQuestion, "üìù");
    }

    function fillSlotsWithCorrectAnswer() {
      const slotDivs = equationArea.querySelectorAll(".slot");
      slotDivs.forEach(div => {
        const idx = Number(div.dataset.index);
        const slot = currentSlots[idx];
        if (!slot) return;
        if (slot.type === "num" || slot.type === "ans") {
          div.textContent = String(slot.correct);
          slot.value = String(slot.correct);
        } else if (slot.type === "op") {
          div.textContent = slot.correct;
          slot.value = slot.correct;
        }
      });
    }

    // --------------- ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ---------------
    function checkAnswer() {
      const t = uiText[currentLang];
      playBeep(440);

      for (let i = 0; i < currentSlots.length; i++) {
        const div = equationArea.querySelector(`.slot[data-index="${i}"]`);
        const val = div ? (div.textContent || "").trim() : "";
        if (!val) {
          setMessage(t.msgNeedFillAll, "üôÇ");
          return;
        }
      }

      let allCorrect = true;
      for (let i = 0; i < currentSlots.length; i++) {
        const slot = currentSlots[i];
        const div = equationArea.querySelector(`.slot[data-index="${i}"]`);
        if (!slot || !div) continue;
        const val = (div.textContent || "").trim();
        currentSlots[i].value = val;

        if (slot.type === "num" || slot.type === "ans") {
          const userVal = Number(val);
          if (userVal !== Number(slot.correct)) {
            allCorrect = false;
          }
        } else if (slot.type === "op") {
          if (val !== slot.correct) {
            allCorrect = false;
          }
        }
      }

      if (allCorrect) {
        score++;
        playSuccessSound();
        launchConfetti(70);
        setSlotsDisabled(true);
        renderTopBar();
        setMessage(t.msgCorrect, "üòä");
      } else {
        attempts++;
        playFailSound();
        if (attempts === 1) {
          setMessage(t.msgTryAgain, "üòÖ");
        } else {
          fillSlotsWithCorrectAnswer();
          setSlotsDisabled(true);
          setMessage(t.msgShowAnswer, "üìò");
        }
      }
    }

    function goToNextQuestion() {
      const t = uiText[currentLang];
      playBeep(500);
      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        setSlotsDisabled(true);
        playFinishSetSound();
        launchConfetti(120);
        const total = questions.length;
        const msg =
          score === total
            ? t.finishPerfect(score, total)
            : t.finishNormal(score, total);
        setMessage(msg, "üèÜ");
      }
    }

    function resetAllSlots() {
      const t = uiText[currentLang];
      const slotDivs = equationArea.querySelectorAll(".slot");
      slotDivs.forEach(div => {
        if (!div.classList.contains("disabled")) {
          div.textContent = "";
        }
      });
      currentSlots = currentSlots.map(s => (s ? { ...s, value: "" } : s));
      attempts = 0;
      setSlotsDisabled(false);
      setMessage(t.msgResetEq, "üîÅ");
    }

    // --------------- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤ ---------------
    langButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const lang = btn.dataset.lang;
        if (!lang || lang === currentLang) return;
        currentLang = lang;
        langButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        updateStartScreenTexts();

        if (gameScreen.style.display === "block") {
          renderQuestion();
        }
        playBeep(700);
      });
    });

    // --------------- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° ---------------
    startBtn.addEventListener("click", () => {
      playBeep(620);
      const t = uiText[currentLang];
      const name = nameInput.value.trim();
      studentName = name || (currentLang === "th" ? "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" : "Student");
      currentIndex = 0;
      score = 0;

      nameDisplay.textContent = t.topName(studentName);
      renderTopBar();

      startScreen.style.display = "none";
      gameScreen.style.display = "block";
      renderQuestion();
    });

    // --------------- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏° ---------------
    backHomeBtn.addEventListener("click", () => {
      playBeep(380);
      gameScreen.style.display = "none";
      startScreen.style.display = "block";
      setMessage("", "");
      updateStartScreenTexts();
    });

    checkBtn.addEventListener("click", () => {
      checkAnswer();
    });

    nextBtn.addEventListener("click", () => {
      goToNextQuestion();
    });

    keypadButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.dataset.key;
        if (!key) return;
        playBeep(700);

        const t = uiText[currentLang];

        if (selectedSlotIndex === null) {
          setMessage(t.msgHintSelectSlot, "üëâ");
          return;
        }

        const slot = currentSlots[selectedSlotIndex];
        const div = equationArea.querySelector(`.slot[data-index="${selectedSlotIndex}"]`);
        if (!slot || !div || div.classList.contains("disabled")) return;

        if (slot.type === "op") {
          if (key === "√ó" || key === "√∑" || key === "+" || key === "-") {
            div.textContent = key;
          }
        } else if (slot.type === "num" || slot.type === "ans") {
          if (/[0-9]/.test(key)) {
            const currentText = (div.textContent || "").trim();
            if (currentText.length >= 3) return;
            div.textContent = currentText + key;
          }
        }
      });
    });

    clearSlotBtn.addEventListener("click", () => {
      const t = uiText[currentLang];
      playBeep(360);
      if (selectedSlotIndex === null) {
        setMessage(t.msgClearSlotNeedSelect, "üßº");
        return;
      }
      const div = equationArea.querySelector(`.slot[data-index="${selectedSlotIndex}"]`);
      if (div && !div.classList.contains("disabled")) {
        div.textContent = "";
      }
    });

    clearAllBtn.addEventListener("click", () => {
      playBeep(340);
      resetAllSlots();
    });

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
    updateStartScreenTexts();
  </script>
</body>
</html>
